execute if entity @e[type=#minecraft:mobs,dx=0,dy=0,dz=0,distance=..15,tag=!nodamage,tag=!spectator,nbt=!{active_effects:[{id:"minecraft:blindness"}]}] at @a[gamemode=!spectator,nbt={SelectedItem:{components:{"minecraft:custom_data":{upgradable:1,stblind:1}}}}] if score @a[gamemode=!spectator,distance=..0.001,limit=1] lbcID2 = @s lbcID2 as @a[gamemode=!spectator,distance=..0.001,limit=1] at @s if predicate lbc:chance3 run function lbc:other/magic_academy/can_upgrade