scoreboard players set tmp lbc.math 0
execute store result score tmp lbc.math if entity @e[distance=..10,type=#mobs,tag=!spectator,tag=!rcdenyalways,tag=!sauvojen_tuntija]
execute if score tmp lbc.math matches 10.. at @a[gamemode=!spectator,nbt={Inventory:[{components:{"minecraft:custom_data":{"upgradable": true,"lightningwand": true}}}]}] if score @a[gamemode=!spectator,nbt={Inventory:[{components:{"minecraft:custom_data":{"upgradable": true,"lightningwand": true}}}]},limit=1,distance=..0.001] lbcID2 = @s lbcID2 as @a[gamemode=!spectator,nbt={Inventory:[{components:{"minecraft:custom_data":{"upgradable": true,"lightningwand": true}}}]},limit=1,distance=..0.001] at @s run function lbc:other/magic_academy/can_upgrade